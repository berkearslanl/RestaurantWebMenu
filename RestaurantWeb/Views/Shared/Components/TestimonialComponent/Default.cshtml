@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer localizer
@model List<Comment>
<style>
    /* Modal Arka Planı */
    .custom-modal {
        display: none;
        position: fixed;
        z-index: 9999;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.85); /* Saydam siyah */
        backdrop-filter: blur(5px); /* Arkayı hafif bulanıklaştırır */
    }

    /* Modal Kutusu */
    .custom-modal__content {
        background-color: #111; /* Sitenin koyu tonu */
        margin: 10% auto;
        padding: 40px;
        border: 1px solid #333;
        width: 90%;
        max-width: 600px;
        border-radius: 8px;
        position: relative;
        box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    /* Kapatma Butonu */
    .custom-modal__close {
        color: #555;
        position: absolute;
        right: 20px;
        top: 10px;
        font-size: 35px;
        font-weight: bold;
        cursor: pointer;
        transition: 0.3s;
    }

        .custom-modal__close:hover {
            color: #fff;
        }

    /* Input Stil Ayarı */
    .custom-modal input, .custom-modal textarea {
        background-color: #1a1a1a !important;
        border: 1px solid rgba(255, 255, 255, 0.1) !important;
        padding: 15px !important; /* Yazıları kenardan uzaklaştırır */
        border-radius: 4px;
        transition: all 0.3s ease;
        color: #fff !important;
    }

        .custom-modal input:focus, .custom-modal textarea:focus {
            border-color: #4a7c6d !important; /* Buton rengiyle uyumlu focus */
            outline: none;
        }
</style>
<section id="testimonials" class="container s-testimonials">

    <div class="row s-testimonials__content">
        <div class="column xl-12">

            <h3 class="testimonials-title u-text-center">@localizer["Müşterilerimiz Ne Diyor"]</h3>

            <div class="swiper-container testimonials-slider">
                <div class="swiper-wrapper">

                    @foreach (var x in Model)
                    {

                        <div class="testimonials-slider__slide swiper-slide">
                            <div class="testimonials-slider__author">
                                <img src="https://cdn-icons-png.flaticon.com/512/18/18601.png" alt="Author image" class="testimonials-slider__avatar">
                                <cite class="testimonials-slider__cite">
                                    @x.Username
                                    <span>@x.City</span>
                                </cite>
                            </div>
                            <p>
                                @x.Content
                            </p>
                        </div>
                    }

                </div> <!-- end swiper-wrapper -->

                <div class="swiper-pagination"></div>

            </div> <!-- end testimonials-slider -->


            <div class="u-text-center" style="margin-top: 4rem;">
                <p style="color: rgba(255,255,255,0.6);">@localizer["Deneyiminizi bizimle paylaşmak ister misiniz?"]</p>
                <button id="openCommentModal" class="btn btn--primary">@localizer["Yorum Yap"]</button>
            </div>


        </div> <!-- end column -->
    </div> <!-- end s-testimonials__content -->

</section>

<div id="commentModal" class="custom-modal">
    <div class="custom-modal__content">
        <span class="custom-modal__close">&times;</span>
        <h4 style="color: #fff; margin-bottom: 2rem;">@localizer["Değerli Yorumunuzu Bize İletin"]</h4>

        <form id="commentForm" asp-controller="Comment" asp-action="LeaveComment" method="post">
            <div class="row">
                <div class="column xl-6 md-12">
                    <input class="u-fullwidth" name="Username" type="text" placeholder="@localizer["Adınız Soyadınız"]" required>
                </div>
                <div class="column xl-6 md-12">
                    <input class="u-fullwidth" name="City" type="text" placeholder="@localizer["Şehriniz"]">
                </div>
                <div class="column xl-12">
                    <textarea class="u-fullwidth" name="Content" placeholder="@localizer["Yorumunuz..."]" style="min-height: 150px;" required></textarea>
                </div>
                <div class="column xl-12">
                    <button type="submit" class="btn btn--primary u-fullwidth">@localizer["Gönder"]</button>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    var modal = document.getElementById("commentModal");
    var btn = document.getElementById("openCommentModal");
    var span = document.getElementsByClassName("custom-modal__close")[0];

    // Butona basınca aç
    btn.onclick = function() {
        modal.style.display = "block";
        document.body.style.overflow = "hidden"; // Sayfanın arkada kaymasını engeller
    }

    // X'e basınca kapat
    span.onclick = function() {
        modal.style.display = "none";
        document.body.style.overflow = "auto";
    }

    // Modal dışına (boşluğa) basınca kapat
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
            document.body.style.overflow = "auto";
        }
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    @if (TempData["commentSuccess"] != null)
    {
                    <text>
                    Swal.fire({
                        title: '<span style="font-size: 32px;">@localizer["Teşekkürler!"]</span>',
                            html: '<p style="font-size: 20px;">@localizer["Değerli yorumunuz iletilmiştir. Onaylandıktan sonra yayınlanacaktır."]</p>',
                        icon: 'success',
                        iconColor: '#52796f', // Formundaki yeşil buton tonu
                        background: '#151515', // Projenin arka plan siyahı
                        color: '#ffffff',
                        width: '600px',        // Pencere genişliği (Varsayılan 32em'dir, biz büyüttük)
                        padding: '3em',        // İç boşluk
                        confirmButtonColor: '#52796f',
                        confirmButtonText: '<span style="padding: 0 30px; font-size: 18px;">@localizer["Tamam"]</span>',
                        showClass: {
                            popup: 'animate__animated animate__fadeInDown' // Varsa animasyon kütüphanenle uyumlu olur
                        }
                    });
                    </text>
    }
</script>