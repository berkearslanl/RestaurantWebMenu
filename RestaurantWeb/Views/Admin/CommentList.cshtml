@model List<RestaurantWeb.DAL.Entities.Comment>
@{
    ViewData["Title"] = "CommentList";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}


@{

    string textclass = "";
    string text = "";
    string title = "";
    string iconclass = "";
    string butonclass = "";
    string ex = "";
}

<div class="container-fluid">
    <div class="row mb-4">
        <div class="col-12">
            <h2 class="fw-bold">Müşteri Yorumları</h2>
            <p class="text-white">Sitede yayınlanan yorumları buradan denetleyebilir, onaylayabilir veya yayından kaldırabilirsiniz.</p>
        </div>
    </div>

    <div class="admin-card shadow-sm">
        <div class="table-responsive">
            <table class="table table-dark table-hover align-middle">
                <thead>
                    <tr class="text-muted border-bottom border-secondary">
                        <th style="width: 50px;">#</th>
                        <th>Ad Soyad / Şehir</th>
                        <th style="width: 40%;">Yorum İçeriği</th>
                        <th class="text-center">Durum</th>
                        <th class="text-end">İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        if (item.IsSeeHome == true)
                        {
                            textclass = "badge bg-success-subtle text-success border border-success px-3";
                            text = "Yayında";
                            title = "Yayından Kaldır";
                            iconclass = "fa-solid fa-eye-slash";
                            butonclass = "btn btn-sm btn-outline-warning";
                            ex = "/Admin/CommentDontSeeHome";
                        }
                        else
                        {
                            textclass = "badge bg-warning-subtle text-warning border border-warning px-3";
                            text = "Onay Bekliyor";
                            title = "Onayla ve Yayınla";
                            iconclass = "fa-solid fa-check-double";
                            butonclass = "btn btn-sm btn-outline-success";
                            ex = "/Admin/CommentSeeHome";
                        }

                        <tr>
                            <td>@item.CommentId</td>
                            <td>
                                <div class="fw-bold">@item.Username</div>
                                <small class="text-white">@item.City</small>
                            </td>
                            <td>
                                <div class="comment-text text-white small" title="@item.Content">
                                    @(item.Content.Length > 100 ? item.Content.Substring(0, 100) + "..." : item.Content)
                                </div>
                            </td>
                            <td class="text-center">
                                <span class="@textclass">@text</span>
                            </td>
                            <td class="text-end">
                                <div class="btn-group">
                                    @* Durum Değiştirme *@
                                    <a href="@ex/@item.CommentId" class="@butonclass me-2" title="@title">
                                        <i class="@iconclass"></i>
                                    </a>
                                    @* Silme (Opsiyonel: Yorumu tamamen sistemden kaldırmak için) *@
                                    <a href="/Admin/CommentDelete/@item.CommentId" class="btn btn-sm btn-outline-danger" title="Yorumu Sil">
                                        <i class="fa-solid fa-trash-can"></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<style>
    .comment-text {
        max-width: 350px;
        line-height: 1.4;
        font-style: italic;
    }

    .badge {
        font-size: 0.75rem;
        letter-spacing: 0.5px;
    }

    .table-hover tbody tr:hover {
        background-color: rgba(255, 255, 255, 0.02);
    }
</style>

